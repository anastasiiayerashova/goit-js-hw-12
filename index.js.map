{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"46106680-1f6bf9cc8c5ebc2359fb269e0\";\n\nexport async function fetchData(query, page = 1) {\n    const params = {\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n        per_page: 15,\n        page,\n    };\n    \n    const urlParams = new URLSearchParams(params);\n    const response = await axios.get(`${BASE_URL}?key=${API_KEY}&${urlParams}`);\n    return response.data;\n};\n\n","import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { fetchData } from \"./pixabay-api\";\n\nlet ul = document.querySelector(\".gallery\");\n\nexport function showErrorMessage(message) {\n    iziToast.error({\n        title: 'Error',\n        message,\n    });\n}\n\nexport function toggleLoader(isHidden, index = null) {\n    const loaders = document.querySelectorAll(\".loader\");\n    console.log('Toggling loader at index:', index);\n    if (index !== null) {\n        loaders[index]?.classList.toggle('visually-hidden', isHidden);\n    }\n    else {\n        loaders.forEach(loader => {\n            loader.classList.toggle('visually-hidden', isHidden);\n        });\n    }\n}\n\nexport function renderMarkup(data, imgGallery) {\n    const markup = data.hits.map(image => `<li class=\"image\">\n        <a class = \"gallery-link\" href = \"${image.largeImageURL}\">  \n        <img src = \"${image.webformatURL}\" alt = \"${image.tags}\" class = \"image\" />\n        </a>\n        <div class = \"card-body\">   \n          <p class=\"text\">Likes <span class = \"value\">${image.likes}</span></p>\n          <p class=\"text\">Views <span class = \"value\">${image.views}</span></p>\n          <p class=\"text\">Comments <span class = \"value\">${image.comments}</span></p>\n          <p class=\"text\">Downloads <span class = \"value\">${image.downloads}</span></p>\n          </div>\n        </li>`).join(\"\");\n    \n    imgGallery.insertAdjacentHTML(\"beforeend\", markup);\n\n    let lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',        \n    captionPosition: 'bottom',  \n    captionDelay: 250, \n    });\n    \n    lightbox.refresh();\n}","import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { fetchData } from \"./js/pixabay-api\";\nimport { showErrorMessage, toggleLoader, renderMarkup } from \"./js/render-functions\";\n\ndocument.head.insertAdjacentHTML(\"beforeend\", `<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n<link href=\"https://fonts.googleapis.com/css2?family=Montserrat:ital@0;1&display=swap\" rel=\"stylesheet\"><link href=\"https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,500;1,500&display=swap\" rel=\"stylesheet\">`)\n\nlet ul = document.querySelector(\".gallery\");\nconst btn = document.querySelector(\".btn\");\nconst form = document.querySelector(\".container\");\nlet loadBtn = document.querySelector(\".load-btn\");\n\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet totalHits = 0;\n\nasync function checkForm(event) {\n\n    event.preventDefault();\n    ul.innerHTML = \"\";\n    loadBtn.classList.add(\"visually-hidden\");\n    currentQuery = form.elements.query.value.trim();\n    currentPage = 1;\n    toggleLoader(false, 0);\n   \n    if ( !currentQuery) {\n        showErrorMessage('Sorry, there are no images matching your search query. Please try again!');\n        toggleLoader(true, 0);\n        return;\n    }\n    \n    btn.disabled = true;\n    \n    try {\n        const data = await fetchData(currentQuery, currentPage);\n        toggleLoader(false, 0);\n        if (data.hits.length === 0) {\n            showErrorMessage('Sorry, there are no images matching your search query. Please try again!');\n            return;\n        }\n\n        totalHits = data.totalHits;\n        renderMarkup(data, ul);\n\n        const totalPages = Math.ceil(totalHits / data.hits.length);\n       \n        if (currentPage < totalPages) {\n            toggleLoader(false, 0);\n             loadBtn.classList.remove(\"visually-hidden\");\n        }\n\n        else {\n             loadBtn.classList.add(\"visually-hidden\");\n        }\n       \n        form.reset();\n    }\n\n    catch (error) {\n        showErrorMessage(error.message);\n    }\n        \n    finally {\n        toggleLoader(true, 0)\n        btn.disabled = false;\n    };\n}\n\nasync function clickOnBtn() {\n\n    currentPage += 1;\n    toggleLoader(true, 1);\n\n    try {\n        const data = await fetchData(currentQuery, currentPage);\n\n        toggleLoader(false, 1);\n        renderMarkup(data, ul);\n        \n        const { height: cardHeight } = document.querySelector(\".image img\").getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        });\n\n        const totalPages = Math.ceil(data.totalHits / data.hits.length);\n\n        if (currentPage >= totalPages) {\n            toggleLoader(true, 1);\n             loadBtn.classList.add(\"visually-hidden\");\n            \n            return iziToast.error({\n            position: \"topRight\",\n            message: \"We're sorry, but you've reached the end of search results.\"\n        });\n    }\n    }\n    \n    catch (error) {\n        console.log(error)\n    }\n\n    finally {\n        toggleLoader(true, 1)\n    }\n}\n\nform.addEventListener(\"submit\", checkForm);\nloadBtn.addEventListener(\"click\", clickOnBtn);"],"names":["BASE_URL","API_KEY","fetchData","query","page","params","urlParams","axios","showErrorMessage","message","iziToast","toggleLoader","isHidden","index","loaders","_a","loader","renderMarkup","data","imgGallery","markup","image","SimpleLightbox","ul","btn","form","loadBtn","currentPage","currentQuery","totalHits","checkForm","event","totalPages","error","clickOnBtn","cardHeight"],"mappings":"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"}